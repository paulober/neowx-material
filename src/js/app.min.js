function formatNumber(e,t){return t=t.replace(/[^0-9]/g,""),e.toFixed(t)}$(function(){$('[data-toggle="tooltip"]').tooltip()});var client,mqttConnected=!(window.onbeforeunload=function(){mqttDisconnect()});function startsWithAlert(e,t){if(t.startsWith("alert-"))return t}function mqttConnectedStateChanged(){var e=jQuery("#live-connection-alert");e.removeClass("alert-warning alert-danger alert-info alert-success"),mqttConnect?(e.html('<i class="bi bi-check-circle-fill"></i>'+'<div class="ms-1">Live mit Wetterstation verbunden.</div>'),e.addClass("alert-success")):(e.html('<i class="bi bi-exclamation-triangle-fill"></i>'+'<div class="ms-1">Es konnte leider keine Live-Verbindung hergestellt werden.</div>'),e.addClass("alert-danger"))}function onConnected(){try{client.subscribe("weather/loop"),mqttConnected=!0,console.log("Live Connected"),mqttConnectedStateChanged()}catch(e){console.log("Failed to subscribe to topic!"),console.log(error)}}function onFailure(){mqttConnected=!1}function onConnectionLost(e){mqttConnected=!1,0!==e.errorCode&&(console.error("Live-Connection lost!"),console.error(e.errorMessage),mqttConnectedStateChanged())}function onMessageArrived(e){console.log("MQTT: New data incomming"),update_current_wx(e.payloadString)}function mqttConnect(){(client=new Paho.MQTT.Client("broker.ikg-wetter.de",8081,"webapp"+Math.floor(999999999*Math.random()))).onConnectionLost=onConnectionLost,client.onMessageArrived=onMessageArrived,client.connect({timeout:13,useSSL:!0,mqttVersion:3,onSuccess:onConnected,onFailure:onFailure})}function mqttDisconnect(){null!==client&&(client.unsubscribe("weather/loop"),client.disconnect())}function update_current_wx(i){var e,t;(i=jQuery.parseJSON(i)).hasOwnProperty("dateTime")&&(e=(t=new Date(1e3*i.dateTime)).toLocaleDateString(),t=t.toLocaleTimeString(),jQuery("#last-refresh-datetime-display").html(e+" "+t)),jQuery(".temprow").find("h4").each(function(){var e,t,o,r,n,a=jQuery(this).attr("class").split(" ")[1];a.toLowerCase()==="outTemp".toLowerCase()?i.hasOwnProperty(a="outTemp_C")&&(e=parseFloat(i[a]).toFixed(1),jQuery(this).html(e.toString()+"°C")):a.toLowerCase()==="outHumidity".toLowerCase()?i.hasOwnProperty(a)&&(t=parseFloat(i[a]).toFixed(0),jQuery(this).html(t.toString()+"%")):a.toLowerCase()==="barometer".toLowerCase()?i.hasOwnProperty(a="barometer_hPa")&&(o=parseFloat(i[a]).toFixed(1),jQuery(this).html(o.toString()+" hPa")):a.toLowerCase()==="windSpeed".toLowerCase()?i.hasOwnProperty(a="windSpeed_kph")&&i.hasOwnProperty("windDir")&&(r=292.5<(t=i.windDir)&&t<=337.5?"NW":247.5<t&&t<=292.5?"W":202.5<t&&t<=247.5?"SW":157.5<t&&t<=202.5?"S":112.5<t&&t<=157.5?"SO":67.5<t&&t<=112.5?"O":22.5<t&&t<=67.5?"NO":337.5<t||t<=22.5?"N":"",o=Array.from(document.getElementsByClassName("wi-wind").item(0).classList),jQuery(".wi-wind").removeClass(o.filter(e=>e.startsWith("from")&&e.endsWith("-deg")).join(" ")).addClass("from-"+parseFloat(parseFloat(t).toFixed(0)).toString()+"-deg"),r=parseFloat(parseFloat(i[a]).toFixed(0))+" km/h "+r,jQuery(this).html(r)):a.toLowerCase()==="rain".toLowerCase()?a="rainRate_cm_per_hour":a.toLowerCase()==="windchill".toLowerCase()?i.hasOwnProperty(a="windchill_C")&&(r=parseFloat(i.windchill_C).toFixed(1),jQuery(this).html(r.toString()+"°C")):a.toLowerCase()==="UV".toLowerCase()?i.hasOwnProperty(a)&&(n=parseFloat(i[a]).toFixed(1),jQuery(this).html(n)):a.toLowerCase()==="radiation".toLowerCase()?i.hasOwnProperty(a="radiation_Wpm2")&&(n=parseFloat(i[a]).toFixed(0),jQuery(this).html(n.toString()+" W/m²")):a.toLowerCase()==="cloudbase".toLowerCase()&&i.hasOwnProperty(a="cloudbase_meter")&&(a=parseFloat(i[a]).toFixed(0),jQuery(this).html(a.toString()+" Meter"))})}
//# sourceMappingURL=app.min.js.map